<!doctype html>
<html class="no-js" lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>13.交互式输入 - Python2.7中文文档 - 大屎蛋教程网</title>
    <meta name="description" content="Python交互式输入.行编辑，历史回溯，快捷键绑定.">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Expires" content="0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="Cache" content="no-cache">

    <link rel="stylesheet" href="http://dashidan.com/css/bootstrap.css">
    <link rel="stylesheet" href="http://dashidan.com/css/dashidan.css">

    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?6632e058970afc4f6d1475330c7682cd";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
</head>
<body>
<nav class="navbar navbar-default">
    <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://m.dashidan.com/index.html">大屎蛋教程网</a>
    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav navbar-right">
            <li><a href="http://m.dashidan.com/index.html">首页</a></li>
            <li><a href="http://m.dashidan.com/about.html">关于</a></li>
            <li><a href="http://m.dashidan.com/thanks.html">鸣谢</a></li>
        </ul>
    </div>
</nav>

<div class="container-fluid">
    <div>
        <script type="text/javascript">
            /*20:5 创建于 2018/3/24*/
            var cpro_id = "u3395670";
        </script>
        <script type="text/javascript" src="//cpro.baidustatic.com/cpro/ui/cm.js"></script>

        <a href="http://m.dashidan.com/index.html">首页</a> > <a
            href="http://m.dashidan.com/article/python/index.html">python</a> > doc27
        > 13.交互式输入
    </div>

    <div class="single_line">
        <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4 text-right">
            <a href="http://m.dashidan.com/article/python/doc27/12.html"> &lt; 上一篇</a>
        </div>
        <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4 text-center">
            <a href="http://m.dashidan.com/article/python/index.html">目录</a>
        </div>
        <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4 text-left">
            <a href="http://m.dashidan.com/article/python/doc27/14.html"> 下一篇 &gt;</a>
        </div>
    </div>

    <div class="dsd_content">
        <div class="col-12">
            <article class="dsd_title_1"><h1>13.交互式输入</h1></article>
            <div id="xs_content_border">
                <div>
                    <div class="dsd_catalog"><h3>目录</h3><a href="#1">1 行编辑</a><br><a href="#2">2 历史回溯</a><br><a
                            href="#3">3 快捷键绑定</a><br><a href="#4">4 其它交互式解释器</a></div>
                </div>
                <p>﻿有些版本的 Python 解释器支持输入行编辑和历史回溯，类似 Korn shell 和 GNU bash shell 的功能。这是通过 <code>GNU Readline &lt;http://tiswww.case.edu/php/chet/readline/rltop.html&gt;</code>_
                    库实现的。它支持 Emacs 风格和 vi 风格的编辑。这个库有它自己的文档，在此不重复了。不过，基本的东西很容易演示。交互式编辑和历史查阅在 Unix 和 Cygwin 版中是可选项。 </p>
                <p>本章 <em>不是</em> 马克哈密尔顿的 PythonWin 包和随 Python 发布的基于 TK 的 IDLE 环境的文档。NT 系统和其它 DOS、Windows 系统上的 DOS
                    窗中的命令行历史回调，属于另一个话题。</p>
                <div id="1"><h3>1 行编辑</h3></div>
                <p>如果支持，无论解释器打印主提示符或从属提示符，行编辑都会激活。当前行可以用 Emacs 风格的快捷键编辑。其中最重要的是：:kbd:<code>C-A</code>
                    (Control-A)将光标移动到行首，:kbd:<code>C-E</code> 移动到行尾，:kbd:<code>C-B</code> 向左移一个字符，:kbd:<code>C-F</code>
                    向右移一位。退格向左删除一个符串，:kbd:<code>C-D</code> 向右删除一个字符。:kbd:<code>C-K</code>
                    删掉光标右边直到行尾的所有字符，:kbd:<code>C-Y</code> 将最后一次删除的字符串粘贴到光标位置。:kbd:<code>C-underscore</code> (underscores
                    即下划线，译注)撤销最后一次修改，它可以因积累作用重复。</p>
                <div id="2"><h3>2 历史回溯</h3></div>
                <p>历史代替可以工作。所有非空的输入行都被保存在历史缓存中，获得一个新的提示符的时候，你处于这个缓存的最底的空行。:kbd:<code>C-P</code> 在历史缓存中上溯一行，:kbd:<code>C-N</code>
                    向下移一行。历史缓存中的任一行都可以编辑；按下 :kbd:<code>Return</code> 键时将当前行传入解释器。:kbd:<code>C-R</code>
                    开始一个增量向前搜索；:kbd:<code>C-S</code> 开始一个向后搜索。</p>
                <div id="3"><h3>3 快捷键绑定</h3></div>
                <p>Readline 库的快捷键绑定和其它一些参数可以通过名为 :file:<code>~/.inputrc</code> 的初始化文件的替换命名来定制。快捷键绑定如下形式::</p>
                <pre class="prettyprint"><code>key-name: function-name
</code></pre>
                <p>或者::</p>
                <pre class="prettyprint"><code>"string": function-name
</code></pre>
                <p>选项可以如下设置::</p>
                <pre class="prettyprint"><code>set option-name value
</code></pre>
                <p>例如::</p>
                <pre class="prettyprint"><code># I prefer vi-style editing:
set editing-mode vi

# Edit using a single line:
set horizontal-scroll-mode On

# Rebind some keys:
Meta-h: backward-kill-word
"\C-u": universal-argument
"\C-x\C-r": re-read-init-file
</code></pre>
                <p>需要注意的是 Python 中默认 :kbd:<code>Tab</code> 绑定为插入一个 :kbd:<code>Tab</code> 字符而不是 Readline
                    库的默认文件名完成函数，如果你想用这个，可以将以下内容插入::</p>
                <pre class="prettyprint"><code>Tab: complete
</code></pre>
                <p>到你的 :file:<code>~/.inputrc</code> 中来覆盖它(当然，如果你真的把 :kbd:<code>Tab</code> 设置成这样，就很难在后继行中插入缩进。)。</p>
                <pre class="prettyprint"><code>.. index::
   module: rlcompleter
   module: readline
</code></pre>
                <p>自动完成变量和模块名也可以激活生效。要使之在解释器交互模式中可用，在你的启动文件中加入下面内容: [#]_ ::</p>
                <pre class="prettyprint"><code>import rlcompleter, readline
readline.parse_and_bind('tab: complete')
</code></pre>
                <p>这个操作将 :kbd:<code>Tab</code> 绑定到完成函数，故按 Tab 键两次会给出建议的完成内容；它查找　Python 命名、当前的局部变量、有效的模块名。对于类似 <code>string.a</code>
                    这样的文件名，它会解析 <code>'.'</code> 相关的表达式，从返回的结果对象中获取属性，以提供完成建议。需要注意的是，如果对象的 <code>__getattr__()</code>
                    方法是此表达式的一部分，这可能会执行应用程序定义代码。 </p>
                <p>
                    更有用的初始化文件可能是下面这个例子这样的。要注意一旦创建的名字没用了，它会删掉它们；因为初始化文件作为解释命令与之在同一个命名空间执行，在交互环境中删除命名带来了边际效应。可能你发现了它体贴的保留了一些导入模块，类似
                    <code>os</code>，在解释器的大多数使用场合中都会用到它们::</p>
                <pre class="prettyprint"><code># Add auto-completion and a stored history file of commands to your Python
# interactive interpreter. Requires Python 2.0+, readline. Autocomplete is
# bound to the Esc key by default (you can change it - see readline docs).
#
# Store the file in ~/.pystartup, and set an environment variable to point
# to it:  "export PYTHONSTARTUP=~/.pystartup" in bash.

import atexit
import os
import readline
import rlcompleter

historyPath = os.path.expanduser("~/.pyhistory")

def save_history(historyPath=historyPath):
   import readline
   readline.write_history_file(historyPath)

if os.path.exists(historyPath):
   readline.read_history_file(historyPath)

atexit.register(save_history)
del os, atexit, readline, rlcompleter, save_history, historyPath
</code></pre>
                <div id="4"><h3>4 其它交互式解释器</h3></div>
                <p>
                    跟早先版本的解释器比，现在已经有了很大的进步。不过，还是有些期待没有完成：它应该在后继行中优美的提供缩进(解释器知道下一行是否需要缩进)建议。完成机制可以使用解释器的符号表。命名检查(或进一步建议)匹配括号、引号等等。 </p>
                <p>另有一个强化交互式解释器已经存在一段时间了，它就是 IPython<em>，它支持 tab
                    完成，对象浏览和高级历史管理。它也可以完全定制或嵌入到其它应用程序中。另一个类似的强化交互环境是　bpython</em> 。</p>
                <p>启动交互解释器时，Python 可以执行 <code>PYTHONSTARTUP</code> 环境变量所指定的文件内容。若还要定制化非交互式的 Python，请参阅
                    <code>定制化模块</code>。</p>
                <ul>
                    <li>_IPython: http://ipython.scipy.org/</li>
                    <li>_bpython: http://www.bpython-interpreter.org/</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<hr>

<footer class="single_line">
    <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4 text-right">
        <a href="http://m.dashidan.com/article/python/doc27/12.html"> &lt; 上一篇</a>
    </div>
    <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4 text-center">
        <a href="http://m.dashidan.com/article/python/index.html">目录</a>
    </div>
    <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4 text-left">
        <a href="http://m.dashidan.com/article/python/doc27/14.html"> 下一篇 &gt;</a>
    </div>
</footer>

<script src="http://dashidan.com/js/jquery-3.2.1.min.js"></script>
<script src="http://dashidan.com/js/vendor/modernizr-custom.js"></script>
<script src="http://dashidan.com/js/bootstrap.js"></script>
<script src="http://dashidan.com/js/google-code-prettify/run_prettify.js"></script>
<script src="http://dashidan.com/js/main.js"></script>
</body>
</html>
