<!doctype html>
<html class="no-js" lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>15.附录 - Python2.7中文文档 - 大屎蛋教程网</title>
    <meta name="description" content="Python附录: 交互模式，错误处理，执行python脚本，定制模块。">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Expires" content="0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="Cache" content="no-cache">

    <link rel="stylesheet" href="http://localhost/css/bootstrap.css">
    <link rel="stylesheet" href="http://localhost/css/dashidan.css">

    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?6632e058970afc4f6d1475330c7682cd";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
</head>
<body>
<nav class="navbar navbar-default">
    <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://m.dashidan.com/index.html">大屎蛋教程网</a>
    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav navbar-right">
            <li><a href="http://m.dashidan.com/index.html">首页</a></li>
            <li><a href="http://m.dashidan.com/about.html">关于</a></li>
            <li><a href="http://m.dashidan.com/thanks.html">鸣谢</a></li>
        </ul>
    </div>
</nav>

<div class="container-fluid">
    <div>
        <a href="http://m.dashidan.com/index.html">首页</a> > <a
            href="http://m.dashidan.com/article/python/index.html">python</a> > doc27
        > 15.附录
    </div>

    <div class="single_line">
        <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4 text-right">
                <a href="http://m.dashidan.com/article/python/doc27/14.html"> &lt; 上一篇</a>
        </div>
        <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4 text-center">
            <a href="http://m.dashidan.com/article/python/index.html">目录</a>
        </div>
        <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4 text-left">
        </div>
    </div>

    <div class="dsd_content">
        <div class="col-12">
            <article class="dsd_title_1"><h1>15.附录</h1></article>
            <div id="xs_content_border">
                <div><div class="dsd_catalog"><h3>目录</h3><a href="#﻿1">﻿1 交互模式</a><br><a href="#1.1">&nbsp;&nbsp;1.1 错误处理</a><br><a href="#1.1">&nbsp;&nbsp;1.1 交互执行文件</a><br><a href="#1.2">&nbsp;&nbsp;1.2 执行 Python 脚本</a><br><a href="#1.2">&nbsp;&nbsp;1.2 定制模块</a></div></div><div id="﻿1"><h3>﻿1 交互模式</h3></div>
<div id="1.1"class="dsd_title_c_2"><h4>1.1 错误处理</h4></div>
<p>有错误发生时，解释器会打印一个错误信息和栈跟踪器。在交互模式下，它返回主提示符，如果从文件输入执行，它在打印栈跟踪器后以非零状态退出。(异常可以由 <code>try</code> 语句中的 <code>except</code> 子句来控制，这样就不会出现上文中的错误信息) 有一些非常致命的错误会导致非零状态下退出，这通常由内部矛盾和内存溢出造成。所有的错误信息都写入标准错误流；命令中执行的普通输出写入标准输出。</p>
<p>在主提示符或从属提示符中输入中断符 (通常是 Control-C 或者 DEL) 就会取消当前输入，回到主命令行。[#]_ 执行命令时输入一个中断符会抛出一个 <code>KeyboardInterrupt</code> 异常，它可以被 <code>try</code> 语句截获。</p>
<div id="1.2"class="dsd_title_c_2"><h4>1.2 执行 Python 脚本</h4></div>
<p>BSD 类的 Unix 系统中，Python 脚本可以像 Shell 脚本那样直接执行。只要在脚本文件开头写一行命令，指定文件和模式::</p>
<pre class="prettyprint"><code>#! /usr/bin/env python
</code></pre>
<p>(首先要确认 Python 解释器在用户的 :envvar:<code>PATH</code> 中) <code>#!</code>  必须是文件的前两个字符，在某些平台上，第一行必须以 Unix 风格的行结束符 (<code>'\n'</code>)结束，不能用 Windows (<code>'\r\n'</code>) 的结束符。注意，<code>'#'</code> 是 Python 中是行注释的起始符。 </p>
<p>脚本可以通过 :program:<code>chmod</code> 命令指定执行模式和权限。</p>
<p>.. code-block:: bash</p>
<pre class="prettyprint"><code>$ chmod +x myscript.py
</code></pre>
<p>Windows 系统上没有“执行模式”。Python 安装程序自动将 <code>.py</code> 文件关联到 <code>python.exe</code> ，所以在 Python 文件图标上双击，它就会作为脚本执行。同样 <code>.pyw</code>  也做了这样的关联，通常它执行时不会显示控制台窗口。</p>
<div id="1.1"class="dsd_title_c_2"><h4>1.1 交互执行文件</h4></div>
<p>使用 Python 解释器的时候，我们可能需要在每次解释器启动时执行一些命令。你可以在一个文件中包含你想要执行的命令，设定一个名为 <code>PYTHONSTARTUP</code> 的环境变量来指定这个文件。这类似于 Unix shell 的 :file:<code>.profile</code> 文件。 </p>
<p>这个文件在交互会话期是只读的，当 Python 从脚本中解读文件或以终端 :file:<code>/dev/tty</code> 做为外部命令源时则不会如此 (尽管它们的行为很像是处在交互会话期) 它与解释器执行的命令处在同一个命名空间，所以由它定义或引用的一切可以在解释器中不受限制地使用。你也可以在这个文件中改变 <code>sys.ps1</code> 和 <code>sys.ps2</code>  指令。 </p>
<p>如果你想要在当前目录中执行附加的启动文件，可以在全局启动文件中加入类似以下的代码：<code>if os.path.isfile('.pythonrc.py'): execfile('.pythonrc.py')</code>。如果你想要在某个脚本中使用启动文件，必须要在脚本中写入这样的语句::</p>
<pre class="prettyprint"><code>import os
filename = os.environ.get('PYTHONSTARTUP')
if filename and os.path.isfile(filename):
   with open(filename) as fobj:
      startup_file = fobj.read()
   exec(startup_file)
</code></pre>
<div id="1.2"class="dsd_title_c_2"><h4>1.2 定制模块</h4></div>
<p>Python 提供了两个钩子 (方法) 来本地化: :mod:<code>sitecustomize</code> 和
:mod:<code>usercustomize</code>。为了见识它们，你首先需要找到你的 site-packages 的目录。启动 python 执行下面的代码::</p>
<pre class="prettyprint"><code>&gt;&gt;&gt; import site
&gt;&gt;&gt; site.getusersitepackages()
'/home/user/.local/lib/python2.7/site-packages'
</code></pre>
<p>现在你可以在 site-packages 的目录下创建 :file:<code>usercustomize.py</code> 文件，内容就悉听尊便了。这个文件将会影响 python 的每次调用，除非启动的时候加入 <code>-s</code> 选项禁止自动导入。</p>
<p>:mod:<code>sitecustomize</code> 的工作方式一样，但是是由电脑的管理账户创建以及在 :mod:<code>usercustomize</code> 之前导入。具体可以参见 <code>site</code>。</p>
<p>GNU Readline包的一个问题可能禁止此功能。</p>
            </div>
        </div>
    </div>
</div>

<hr>

<footer class="single_line">
    <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4 text-right">
            <a href="http://m.dashidan.com/article/python/doc27/14.html"> &lt; 上一篇</a>
    </div>
    <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4 text-center">
        <a href="http://m.dashidan.com/article/python/index.html">目录</a>
    </div>
    <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4 text-left">
    </div>
</footer>

<script src="http://m.dashidan.com/js/jquery-3.2.1.min.js"></script>
<script src="http://m.dashidan.com/js/vendor/modernizr-custom.js"></script>
<script src="http://m.dashidan.com/js/bootstrap.js"></script>
<script src="http://m.dashidan.com/js/google-code-prettify/run_prettify.js"></script>
<script src="http://m.dashidan.com/js/main.js"></script>
</body>
</html>
